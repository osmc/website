!function(e,t){"use strict";!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t("object"==typeof exports?require("jquery"):e.jQuery||e.Zepto)}(function(n){var a=this||{},o="",i=0,s=0,r=0,l=".adunit",d=!1,c=!1,u="googleAdUnit",f=function(e,t,s){var l;i=0,r=0,o=e,l=n(t),a.shouldCheckForAdBlockers=function(){return s?"function"==typeof s.afterAdBlocked:!1},E(s,l).then(function(){s=g(s),a.dfpOptions=s,n(function(){p(s,l),h(s,l)})})},g=function(a){var o={setTargeting:{},setCategoryExclusion:"",setLocation:"",enableSingleRequest:!0,collapseEmptyDivs:"original",refreshExisting:!0,disablePublisherConsole:!1,disableInitialLoad:!1,noFetch:!1,namespace:t,sizeMapping:{}};if("undefined"==typeof a.setUrlTargeting||a.setUrlTargeting){var i=m(a.url);n.extend(!0,o.setTargeting,{UrlHost:i.Host,UrlPath:i.Path,UrlQuery:i.Query})}return n.extend(!0,o,a),o.googletag&&e.googletag.cmd.push(function(){n.extend(!0,e.googletag,o.googletag)}),o},p=function(t,s){var l=e.googletag;s.each(function(){var e=n(this);i++;var a=b(e,t),s=v(e,a),r=y(e);e.data("existingContent",e.html()),e.html("").addClass("display-none"),l.cmd.push(function(){var i,d=e.data(u);if(d)i=d;else{var c;c=""===o?a:"/"+o+"/"+a,e.data("outofpage")?i=l.defineOutOfPageSlot(c,s):(i=l.defineSlot(c,r,s),e.data("companion")&&(i=i.addService(l.companionAds()))),i=i.addService(l.pubads())}var f=e.data("targeting");f&&n.each(f,function(e,t){i.setTargeting(e,t)});var g=e.data("exclusions");if(g){var p,h=g.split(",");n.each(h,function(e,t){p=n.trim(t),p.length>0&&i.setCategoryExclusion(p)})}var m=e.data("size-mapping");if(m&&t.sizeMapping[m]){var v=l.sizeMapping();n.each(t.sizeMapping[m],function(e,t){v.addSize(t.browser,t.ad_sizes)}),i.defineSizeMapping(v.build())}e.data(u,i),"function"==typeof t.beforeEachAdLoaded&&t.beforeEachAdLoaded.call(this,e)})}),l.cmd.push(function(){var e=l.pubads();t.enableSingleRequest&&e.enableSingleRequest(),n.each(t.setTargeting,function(t,n){e.setTargeting(t,n)});var o=t.setLocation;if("object"==typeof o&&("number"==typeof o.latitude&&"number"==typeof o.longitude&&"number"==typeof o.precision?e.setLocation(o.latitude,o.longitude,o.precision):"number"==typeof o.latitude&&"number"==typeof o.longitude&&e.setLocation(o.latitude,o.longitude)),t.setCategoryExclusion.length>0){var d,c=t.setCategoryExclusion.split(",");n.each(c,function(t,a){d=n.trim(a),d.length>0&&e.setCategoryExclusion(d)})}t.collapseEmptyDivs&&e.collapseEmptyDivs(),t.disablePublisherConsole&&e.disablePublisherConsole(),t.companionAds&&(l.companionAds().setRefreshUnfilledSlots(!0),t.disableInitialLoad||e.enableVideoAds()),t.disableInitialLoad&&e.disableInitialLoad(),t.noFetch&&e.noFetch(),e.addEventListener("slotRenderEnded",function(e){r++;var a=n("#"+e.slot.getSlotId().getDomId()),o=e.isEmpty?"none":"block",l=a.data("existingContent");"none"===o&&n.trim(l).length>0&&"original"===t.collapseEmptyDivs&&(a.show().html(l),o="block display-original"),a.removeClass("display-none").addClass("display-"+o),"function"==typeof t.afterEachAdLoaded&&t.afterEachAdLoaded.call(this,a,e),"function"==typeof t.afterAllAdsLoaded&&r===i&&t.afterAllAdsLoaded.call(this,s)}),a.shouldCheckForAdBlockers()&&!l._adBlocked_&&setTimeout(function(){var o=e.getSlots?e.getSlots():[];o.length>0&&n.get(o[0].getContentUrl()).always(function(e){200!==e.status&&n.each(o,function(){var e=n("#"+this.getSlotId().getDomId());t.afterAdBlocked.call(a,e,this)})})},0),l.enableServices()})},h=function(t,o){var i=e.googletag;if(a.shouldCheckForAdBlockers()&&!i._adBlocked_&&i.getVersion){var s="//partner.googleadservices.com/gpt/pubads_impl_"+i.getVersion()+".js";n.getScript(s).always(function(e){e&&"error"===e.statusText&&n.each(o,function(){t.afterAdBlocked.call(a,n(this))})})}o.each(function(){var e=n(this),o=e.data(u);i._adBlocked_&&a.shouldCheckForAdBlockers()&&t.afterAdBlocked.call(a,e),i.cmd.push(t.refreshExisting&&o&&e.hasClass("display-block")?function(){i.pubads().refresh([o])}:function(){i.display(e.attr("id"))})})},m=function(t){var n=(t||e.location.toString()).match(/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/),a=n[4]||"",o=(n[5]||"").replace(/(.)\/$/,"$1"),i=n[7]||"",s=i.replace(/\=/gi,":").split("&");return{Host:a,Path:o,Query:s}},v=function(e,t){return s++,e.attr("id")||e.attr("id",t.replace(/[^A-z0-9]/g,"_")+"-auto-gen-id-"+s).attr("id")},b=function(e,t){var n=e.data("adunit")||t.namespace||e.attr("id")||"";return"function"==typeof t.alterAdUnitName&&(n=t.alterAdUnitName.call(this,n,e)),n},y=function(e){var t=[],a=e.data("dimensions");if(a){var o=a.split(",");n.each(o,function(e,n){var a=n.split("x");t.push([parseInt(a[0],10),parseInt(a[1],10)])})}else t.push([e.width(),e.height()]);return t},E=function(t,o){function i(){a.shouldCheckForAdBlockers()&&n.each(o,function(){t.afterAdBlocked.call(a,n(this))})}if(c=c||n('script[src*="googletagservices.com/tag/js/gpt.js"]').length)return d&&i(),n.Deferred().resolve();var s=n.Deferred();e.googletag=e.googletag||{},e.googletag.cmd=e.googletag.cmd||[];var r=document.createElement("script");r.async=!0,r.type="text/javascript",r.onerror=function(){k(),s.resolve(),d=!0,i()},r.onload=function(){googletag._loadStarted_||(googletag._adBlocked_=!0,i()),s.resolve()};var l="https:"===document.location.protocol;r.src=(l?"https:":"http:")+"//www.googletagservices.com/tag/js/gpt.js";var u=document.getElementsByTagName("script")[0];return u.parentNode.insertBefore(r,u),"none"===r.style.display&&k(),s},k=function(){var t=e.googletag,o=t.cmd,i=function(e,n,a,o){return t.ads.push(a),t.ads[a]={renderEnded:function(){},addService:function(){return this}},t.ads[a]};t={cmd:{push:function(e){e.call(a)}},ads:[],pubads:function(){return this},noFetch:function(){return this},disableInitialLoad:function(){return this},disablePublisherConsole:function(){return this},enableSingleRequest:function(){return this},setTargeting:function(){return this},collapseEmptyDivs:function(){return this},enableServices:function(){return this},defineSlot:function(e,t,n){return i(e,t,n,!1)},defineOutOfPageSlot:function(e,t){return i(e,[],t,!0)},display:function(e){return t.ads[e].renderEnded.call(a),this}},n.each(o,function(e,n){t.cmd.push(n)})};n.dfp=n.fn.dfp=function(e,n){n=n||{},e===t&&(e=o),"object"==typeof e&&(n=e,e=n.dfpID||o);var a=this;return"function"==typeof this&&(a=l),f(e,a,n),this}})}(window),Discourse.DiscoveryView=Ember.View.extend({_insertBanner:function(){showAd&&(this.$(".list-container").prepend("<div class='toplist_ad' data-adunit='discourse_toplist' data-size-mapping='toplist'></div>"),this.$(".toplist_ad").dfp({dfpID:"302320750",sizeMapping:{toplist:[{browser:[1100,0],ad_sizes:[970,90]},{browser:[810,0],ad_sizes:[728,90]},{browser:[530,0],ad_sizes:[468,60]},{browser:[0,0],ad_sizes:[320,50]}]}})),showBanner&&(this.$(".list-container").prepend("<a href='"+bannerLink+"'><div class='toplist_banner' style='color:#fafafa; padding:2.5em 1em; margin:0.2em 0;'><h2 style='color:white; font-size:130%; font-weight:300; text-align: center;'>"+bannerText+"</h2></div></a>"),this.$(".toplist_banner").css({background:"url("+bannerImg+")"})),showSponsor&&this.$(".list-container").prepend("<a href='"+sponsorLink+"'><div class='toplist_banner' style='margin:0.2em 0;'><img style='max-width:100%' src='"+sponsorImg+"'></a>")}.on("didInsertElement"),_insertDonateButton:function(){this.$(".list-controls .container").before('<a target="_blank" href="https://osmc.tv/blog/#donate"><button class="btn btn-default donate-button"><i class="fa fa-heart"></i>Donate</button></a>')}.on("didInsertElement")}),autoLinks.forEach(function(e){var t=new RegExp(e[0]);Discourse.Dialect.inlineRegexp({start:e[0],matcher:t,spaceBoundary:!0,emitter:function(){setTimeout(function(){var t=$("textarea.ember-text-area"),n=t.val().replace(e[0],e[1]);t.val(n)},500)}})});